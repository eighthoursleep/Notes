# 第1章 从角色走路说起

[toc]

## 1.1 每走一步都有事情发生

## 1.2 从网络编程着手

### 1.2.1 用打电话做比喻

### 1.2.2 最少要掌握的三个概念

#### 1.2.2.1 IP和端口

客户端和服务端有各自的地址，相当于手机号。

网络编程中的“手机号”由IP和端口两部分构成。

例如：“127.0.0.1:8003”
IP: “127.0.0.3”，代表一台设备
端口号：“8003”，代表这台设备中的某个任务

端口是个逻辑概念，用于把不同的网络消息分发给不同的任务。

#### 1.2.2.2 套接字

网络连接的每一段都需要存储一些信息，这些信息至少包括：
- 连接使用的协议
- 自己的地址
- 对方的地址
- 将要发送的数据
- 接收到的数据

存储和处理这些信息的结构称为**套接字（Socket）**。

每个Socket都包含网络连接中一段的信息。

每个客户端需要一个Socket结构。
服务端则需要N+1个Socket结构，其中N为客户端的连接数，另外1个是服务端打开监听的套接字。

#### 1.2.2.3 Socket标识

既然服务端可以接收多个客户端的连接，那么它就需要通过一种方法区分消息来自哪个客户端。

有些语言（Node.js、C#）会直接传递Socket对象，而有些（C、C++）则会用一个数字标识符来代表该Socket对象。

### 1.2.3 搭一个简单的服务器

无论语法怎样，服务端网络模块至少会提供：
- 当客户端连接
- 当收到消息
- 当客户端断开
这三种事件的接口

### 1.2.4 让角色走起来

## 1.3 能够承载多少玩家

### 1.3.1 单线事件模型

### 1.3.2 承载量估算

## 1.4 用分布式扩能

既然单个程序的承载量有限，最直接的办法就是开启多个程序来提高承载量。

### 1.4.1 多个程序协同工作

