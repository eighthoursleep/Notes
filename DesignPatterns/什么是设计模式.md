## 什么是设计模式？

[TOC]

一般而言，一个设计模式有以下4个基本要素：
1. 模式名称
2. 问题：描述了应该在何时使用模式，解释了设计问题和问题存在的前因后果。有时候，问题部分会包括使用模式必须满足的一系列先决条件。
3. 解决方案：描述了设计的组成成分。
4. 效果：描述了模式应用的效果以及使用模式应权衡的问题。

本文的设计模式是**对被用来在特定场景下解决一般设计问题的类和相互通信的对象的描述。**

### 描述设计模式的统一格式

#### 模式名和分类

模式名简洁地描述了模式的本质。（下文详细介绍的23个模式以及分类）

#### 意图

回答下列问题的简单陈述：
1. 这个设计模式是做什么的？
2. 它的基本原理和意图是什么？
3. 它解决的是什么样的特定设计问题？

#### 别名

模式的其他名称

#### 动机

说明一个设计问题以及如何用模式中的类、对象来解决问题的特定情景。该情景会帮助你理解随后对模式更抽象的描述。

#### 适用性

什么情况下可以使用该设计模式？该模式可用来改进哪些不良设计？怎样识别这些情况？

#### 结构

采用基于对象建模技术的表示法对模式中的类进行图形描述。
使用交互图说明对象之间的请求序列和协作关系。

#### 参与者

指设计模式中的类和/或对象，以及它们各自的职责。

#### 协作

模式的参与者怎样协作，以及实现它们的职责。

#### 效果

模式怎样支持它的目标?使用模式的效果和所需要的权衡取舍？系统结构的哪些方面可以独立改变？

#### 实现

实现模式时需要知道的一些提示、技术要点以及应避免的缺陷，以及是否存在某些特定于实现语言的问题。

#### 代码实例

用C++实现该模式的代码片段。

#### 已知应用

实际系统中发现的模式的例子。每个模式至少包括了两个不同领域的实例。

#### 相关模式

与这个模式紧密相关的模式有哪些？其间重要的不同之处是什么？这个模式应与哪些其他模式一起使用？

### 分类的两条准则

#### 目的准则：模式是用来完成使命工作的。

1. 以此可分为：创建型、结构型、行为型
2. 创建型与对象的创建有关，结构型处理类或对象的组合，行为型对类或对象怎样交互和怎样分配职责进行描述。

#### 范围准则：指定模式主要用于类还是用于对象。

1. 类模式处理类和子类之间的关系，关系通过继承建立，是静态的，在编译时变确定下来。
2. 对象模式处理对象间的关系，这些关系在运行时时可变化的，更具动态性。
3. 几乎所有模式都是用继承机制，类模式只指集中处理类间关系的模式，大部分模式属于对象模式。

### 设计模式怎样解决设计问题

#### 寻找合适的对象

**面向对象设计最困难的部分时将系统分解成对象集合。** 因为要考虑许多因素：封装、粒度、依赖关系、灵活性、性能、演化、复用登，它们都影响系统的分解，且这些因素通常时互相冲突的。

面向对象设计方法学支持许多设计方法。描述一个问题，挑出名词、动词，进而创建相应的类和操作；或者关注于系统的协作和职责关系；或者可以对现实世界建模，再将分析时发现的对象转化到设计中，至于哪个方法更好，并无定论。

#### 决定对象的颗粒度

Facade模式描述了怎样用对象表示完成的子系统；
Flyweight模式描述了如何支持大量的最小颗粒度的对象。
AbstractFactory和Builder产生那些专门负责生成其他对象的对象。
Visitor和Command生成的对象专门负责实现其他对象或对象组的请求。

#### 指定对象接口

操作的型构：操作指定的操作名、作为参数的对象和返回值。

对象操作所定义的所有操作型构的集合称为该对象的接口。

对象接口描述了该对象所能接受的全部请求的集合。

任何匹配对象接口中型构的请求都可发送给该对象。

对象解耦与其功能实现时分离的，不同对象可以对请求做不同的实现。

当该对象发送请求时，引起的具体操作既与请求本身有关，又与接受对象有关。支持相同请求的不同对象可能对请求激发的操作有不同的实现。发送给对象的请求和它的相应操作再运行时刻的连接就称为“动态绑定”。

动态绑定指发送的请求直到运行时刻才受你的具体实现的约束。

动态绑定允许你在运行时刻彼此替换有相同接口的对象。

可替换性称为“多态”。多态允许客户对象进要求其他对象支持特定接口，除此之外对其假设几近于无。多态简化了客户的定义，使得对象间彼此独立，并可以在运行时刻动态改变它们相互的关系。

#### 描述对象的实现

##### 类继承于接口继承的比较

1. 类定义了对象怎样实现，也定义了对象的内部状态和操作的实现。
2. 对象的类型只与接口有关，接口即对象能响应的请求的集合。一个对象可以有多个类型，不同类的对象可以有相同的类型。
3. 对象的类和类型紧密相关。类定义了对象所能执行的操作，也定义了对象的类型。

##### 对接口编程，而非对实现编程

只根据抽象类中定义的接口来操纵对象有以下两个好处：
1. 客户无须直到他们使用对象的特定类型，只须对象有客户所期望的接口。
2. 客户无须直到他们使用的对象是用什么类来实现，只须直到定义接口的抽象类。
3. 这极大减少子系统实现之间的相互依赖关系，也产生了可复用的对象。

不将变量声明为某个特定的具体类的实例对象，而是让它遵从抽象类所定义的接口。

#### 运用复用机制

##### 继承和组合的比较

##### 委托

##### 继承和参数化类型的比较

#### 关联运行时刻和编译时刻的结构

#### 设计应支持变化

### 怎样选择设计模式

### 怎样使用设计模式


