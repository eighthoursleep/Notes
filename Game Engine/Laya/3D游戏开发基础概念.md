# 3D游戏开发基础概念

（摘自[Laya官网](https://layabox.com)）



一个简单的3D世界必须要有的元素：场景、摄像机、灯光、模型、材质

## 坐标系与坐标

坐标是3D空间世界的基础之一，干啥都离不开坐标，移动摄像机，定位，绘制图形等。

在使用LayaAir开发3D游戏时，我们需要了解两个坐标，一个是**位置坐标**， 另一个是**UV坐标**。

而了解这两种坐标之前，我们先介绍一下描述空间位置的**笛卡尔直角坐标系**。

笛卡尔直角坐标系是用经过相同原点的**xyz**三条互相垂直的坐标轴相交而构成。

坐标系的两个轴正方向一致的情况下，因第三轴正方向相反，所以将坐标系分为**左手坐标系**与**右手坐标系**。

这两种坐标系没有好或不好，都应用的都比较广泛，比如**Unity**等引擎采用的是**左手坐标系**，**LayaAir**等引擎采用的是**右手坐标系**。

两种3D坐标系之所以用左右手分别命名，是为了便于记忆，分别用左手和右手三根手指的朝向，来代表三个坐标轴的正方向，这三个手指分别是拇指、食指、中指。

无论是左手还是右手，我们要记住，**大拇指朝向**的方向是**x轴正方向**，**食指的朝向**是**y轴的正方向**，**中指的朝向**是**z轴的正方向**。

现在我们**面向屏幕**，准备好双手来摆造型。先将左右两个手的食指（y轴）指向天空方向（在房间的就指天花板），然后将中指（z轴）冲前（立正站立时眼睛平视的方向），此时两个手的中指应该都与食指保持90度垂直。然后，再伸出大拇指（x轴）与食指和中指都保持90度垂直。可以参照下图手势。

![LeftHand](3Dmath\LeftHand.png)

摆好后，我们会发现，在保持z轴和y轴正方向相同的情况下，x轴的正方向是相反的。这就是左手坐标系和右手坐标系的区别。

LayaAir引擎unity导出插件就是以x轴取反来自动适配LayaAir引擎。所以，直接在unity里编辑导出，然后在LayaAir引擎中使用，是不需要手动对坐标进行转换。如果开发者一定要在LayaAir引擎项目中手动来调坐标，那需要注意左手坐标系与右手坐标系在x轴正方向的差异。

## 顶点

顶点可以理解为3D空间中的任意一个带xyz坐标的位置点，但顶点不仅包含了**坐标位置信息**，还有**UV**、**法线**、**颜色等**信息。

UV其实也是坐标， 完整的说应该是UVW（由于xyz已经被顶点坐标轴占用，所以另选三个字母表示）， 这三个轴U是屏幕水平方向，V是屏幕垂直方向，W的方向是垂直于显示器表面的，到目前为止，一般游戏开发是用不上的，所以我们通常就会简称为UV。

去掉了W，那UV坐标就是一个2D平面坐标，**UV坐标**可用于**模型纹理贴图**等。

![UVguide](3Dmath\UVguide.png)

UV坐标的贴图纹理**向右**和**向下**分别是**U**与**V**的坐标正方向。取值范围是**0~1**，不管纹理图片的像素是多少，3D美术制作软件导出的模型顶点数据都会对应贴图纹理的UV坐标，以保障渲染时的采样正确。

![UVguide2](3Dmath\UVguide2.png)

相对于UV坐标最终会对应贴图纹理上的像素点，顶点坐标则没有恒定的计量单位，最小的单位是点，无论是现实世界还是3D世界，点都是一个基础的抽象概念，他代表着一个单独的个体，可以无限大，也可以无限小。

所以，点可以是1个像素，也可以是1毫米、1纳米、1千米等任意单位的基础单元。最终顶点之间用什么计量单位，通常由3D美术结合游戏设计而设定，3D游戏美术用的比较多的单位是米。所以程序的设定要与美术设定的单位保持统一，否则就会造成视觉效果上的过大或过小，出现与设计不符的效果。

## 三角面、网格、模型

模型是3D游戏中可见物的基础，比如人物，房屋，树木，山川，河流等等，几乎绝大多数可见物体都是以模型为基础构成。

要进一步了解模型，我们先从三角形平面（简称三角面）开始，**三角面**是由三个顶点构成，是**显卡唯一能处理的基础多边形**。之所以把三角面视为**最基本的多边形**，其中一个重要原因是，**由三个点构成的三角面一定是在同一个平面上**，而四个或更多点构成的多边形在三维空间中，不一定会在同一个平面上。

而**网格（ Mesh）**则是由一个三角面或多个三角面拼接形成，是**构建模型形状的基础**。在LayaAir引擎中， 构成各种图形形状的三角面**顶点数据**以及三角**面的索引数据**集合就是网格，所以网格在游戏运行时是不可见的，下图是使用像素线精灵来表现模型的网格构成。

![Mesh](3Dmath\Mesh.png)

**模型**是由**网格（ Mesh）与材质（ Material）**组成。从构成三维图形形状而言，**模型的基础是网格，网格的基础是三角面。三角面越多，模型可表现的细节越丰富**。下图正是40000面和4000面及400面的模型细节表现差异。细节表现比较丰富的，通常被称为精模，细节表现相对较弱的，被称为简模。

![Mesh2](3Dmath\Mesh2.png)

到底使用精模还是简模，这需要研发技术结合整体效果和游戏硬件性能可承受的压力情况向美术提出需求，在这一点上，移动端H5及小游戏与手游APP标准可保持相等标准。

### 材质

材质就是材料的质感。例如，木头与金属、玻璃与毛发，从粗糙度、光泽度、反射、透明、颜色、纹理等等方面，不同的材料质感会明显不同。

根据这些物体的差异，我们可以将材质划分为很多种类，LayaAir引擎支持的材质分类为模型材质、天空材质、拖尾材质、粒子材质。（天空、拖尾、粒子尚未提及，我们先介绍模型材质。）

![Material](3Dmath\Material.png)

LayaAir引擎的模型材质还可以继续划分，分别为光照材质（BlinnPhongMaterial）、不受光材质（UnlitMaterial）、特效材质（EffectMaterail）、PBR标准材质（PBRStandardMaterial）、PBR高光材质（PBRSpecularMaterial）、水材质（WaterPrimaryMaterial）。

**BlinnPhong**材质是默认使用的**标准感光材质**

**UnlitMaterial**材质恰恰相反，并**不受光照影响，只显示原贴图的外观图像效果**。

![Material2](3Dmath\Material2.png)

**特效材质（EffectMaterail）** 是一种无需外部光照，通过混合模式让自身产生一种光效视觉效果的材质，常用于特殊效果的制作，所以称为特效材质。

![Material3](3Dmath\Material3.png)

