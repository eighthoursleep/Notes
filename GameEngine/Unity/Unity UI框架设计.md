# Unity UI框架设计

[TOC]

## 无UI框架容易出现的问题

- 多场景会反复出现相同的UI窗体，造成多个场景中反复加载相同的UI窗体。
  - 解决方案：UI框架需要缓存项目中常用的UI窗体。
- 各个UI脚本之间传值，容易出现“紧耦合”情况。
  - 解决方案：各个UI的生成、销毁、切换都通过框架实现，各个UI之间不直接传值。（单例模式传值，只适合框架内部或小型项目中使用）
- 出现UI窗体叠加现象，开发人员需要手动维护窗体中间的层级关系。
  - 解决方案：使用栈的数据结构，保存与控制当前左右需要显示的UI窗体的层级关系。
- 多个UI窗体重叠，必须保持子窗体没有关闭，父窗体禁止操作的状态，否则容易误操作。
  - 解决方案：设计框架本身，需要对当前显示的窗体做遮挡处理，即：不允许用户绕过当前UI窗体，直接操作底仓窗体，或者误点击项目中的3D游戏对象等。

**UI框架需要注意的设计问题：**

1. 要管理加载窗体预设，进行自动加载的管理
2. 需要支持不同的国际语言
3. 核心原则：尽量让框架本身完成与具体业务无关的事务性工作，让开发人员只需要专注游戏业务逻辑的开发。

UI框架

- 窗体自动加载管理
- 缓存窗体
- 窗体层级管理
- 窗体生命周期管理
  - 显示、冻结、再显示、隐藏
- 消息中心
- 父子窗体的实现
- 日志调试系统
- 语言国际化



## 简单架构

最简单框架要实现的功能：

1. 窗体自动加载管理；
2. 缓存UI窗体；
3. 窗体生命周期管理；

UI框架核心类设计：

1. 基础窗体，基类
2. UI窗体管理器
3. 窗体类型
4. 系统定义类



## 窗体层级管理



## 模态窗体管理



## 日志调试与配置管理



## 消息传递中心



## 多语言支持