# UE4网络架构

## 同步

最早的联机同步按照点对点网络的思路进行设计。

**点对点同步**带来的弊端相当得多，毕竟这是一个网状结构。例如：

1. 由于点对点同步带来的传输消耗，因此**网络传输压力会很大**。 
2. 由于点对点同步**不存在“权威”性**，因此当其中一个人作弊时，会影响所有的客户端。且很难判定“作弊”。

因此，经典的服务器-客户端架构模型产生了。

一台（在当年）具有较高性能的主机被选出来，作为中心服务器。 所有的“游戏性相关指令”都会被发往中心服务器进行处理，随后中心服 务器会把世界的状态 同步到各个客户端。

之前的**网状结构**变为了**星型结构** ，且出现了权威服务器的概念。也就意味着，作弊变得更加困难。无法通过直接传递坐标（只能传递游戏性相关指令）给服务端，就算是本地客户端，坐标也来自于服务端同步过来的信息。

我们能把游戏框架切分为两个部分：一部分是“指令”， 是对游戏世界造成影响的代码请求，比如“人物前移3米”、“人物挥刀碰到 了怪物”；另一部分是“状态”，是游戏世界的各种数值状态，比如“当前人物生命值”、“当前怪物生命值”。客户端只能向服务端发送“指令”，服 务端根据指令处理后，改变游戏世界的状态，并将状态同步给每一个客户端。

这是相当优秀的一个设计，对同步考虑了非常多。因此，被作为了现在绝大多数网络同步模型的基本思路。不过这是不够的，因为有另一个非常基本的问题，那就是**延迟**。

## 广义的客户端-服务端模型

> 客户端是对服务端的拙劣模仿

客户端自己也同样运行着一个世界，并不断预 测 服务端的行为。从而不断更新当前世界，以最大程度地接近 服务端 的世界。